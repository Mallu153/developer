<section id="basic-hidden-label-form-layouts">
  <div class="row match-height">
    <div class="col-lg-12 col-md-12 col-12">
      <div class="card">
        <div class="card-header py-1 mt-1">
          <h4 class="card-title">{{ pageTitle }}</h4>
        </div>
        <div class="card-content">
          <div class="card-body">
            <form [formGroup]="srSummaryForm">
              <div class="form-row">
                <div class="col-md-2 col-xl-1 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="productId">Product</label>
                    <ng-select
                      #productSelect
                      [items]="productList"
                      class="custom"
                      [searchable]="false"
                      placeholder="Product"
                      bindLabel="name"
                      bindValue="id"
                      formControlName="productId"
                    >
                      <ng-template ng-header-tmp>
                        <input
                          class="form-control square"
                          type="text"
                          (input)="productSelect.filter($event.target.value)"
                        />
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
                <div class="col-md-2 col-xl-1 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="srId">Sr No</label
                    ><input
                      type="number"
                      placeholder="Enter  Sr  No"
                      id="srId"
                      name="srId"
                      class="form-control square"
                      formControlName="srId"
                    />
                  </div>
                </div>
                <div class="col-md-2 col-xl-1 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="srLineId">Sr Line No</label
                    ><input
                      type="number"
                      id="srLineId"
                      name="srLineId"
                      placeholder="Enter  Sr Line No"
                      class="form-control square"
                      formControlName="srLineId"
                    />
                  </div>
                </div>
                <div class="col-md-3 col-xl-3 col-lg-3 col-sm-3 col-12">
                  <div class="form-group mb-2">
                    <label for="Customer">Customer</label>
                    <input
                      id="custName"
                      type="search"
                      placeholder="Enter  Customer Name"
                      #typeaheadInstance="ngbTypeahead"
                      class="form-control square"
                      (keydown)="typeaheadKeydown($event)"
                      [resultTemplate]="searchResultTemplate"
                      [inputFormatter]="formatter"
                      [ngbTypeahead]="onSearchCustomer"
                      (selectItem)="bindValueOfControl($event, 'customerId')"
                      (change)="onChangeCustomer($event.target.value)"
                      formControlName="customerId"
                    />
                    <ng-template #searchResultTemplate let-r="result" let-t="term">
                      <ngb-highlight [result]="r.businessName" [term]="t"></ngb-highlight>
                    </ng-template>
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="contactId">Contact</label>
                    <ng-select
                      #contactSelect
                      [items]="contactList"
                      class="custom"
                      placeholder="Contact"
                      [searchable]="false"
                      bindLabel="Requestor"
                      bindValue="CUSTOMERCONTACTID"
                       formControlName="contactId"
                    >
                      <ng-template ng-header-tmp>
                        <input
                          class="form-control square"
                          type="text"
                          (input)="contactSelect.filter($event.target.value)"
                        />
                      </ng-template>
                    </ng-select>
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="contactName">Contact Name</label
                    ><input
                      type="text"
                      id="contactName"
                      name="contactName"
                      placeholder="Enter Contact Name"
                      class="form-control square"
                      formControlName="contactName"
                    />
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="contactEmailId">Contact Email</label
                    ><input
                      type="email"
                      id="contactEmailId"
                      name="contactEmailId"
                      placeholder="Enter Contact Email"
                      class="form-control square"
                      formControlName="contactEmailId"
                    />
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="contactPhone">Contact No</label
                    ><input
                      type="number"
                      id="contactPhone"
                      name="contactPhone"
                      placeholder="Enter Contact No"
                      class="form-control square"
                      formControlName="contactPhone"
                    />
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="srFromCreationDate">Sr From</label
                    ><input
                      type="date"
                      id="srFromCreationDate"
                      name="srFromCreationDate"
                      class="form-control square"
                      formControlName="srFromCreationDate"
                    />
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="srToCreationDate">Sr To</label
                    ><input
                      type="date"
                      id="srToCreationDate"
                      [min]="srSummaryForm.value.srFromCreationDate"
                      name="srToCreationDate"
                      class="form-control square"
                      formControlName="srToCreationDate"
                    />
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="quoteCount">Quote Count</label
                    ><input
                      type="number"
                      placeholder="Enter  Quote Count"
                      id="quoteCount"
                      name="quoteCount"
                      class="form-control square"
                      formControlName="quoteCount"
                    />
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="pnrOrBookingCount">PNR Or Booking Count</label
                    ><input
                      type="number"
                      placeholder="Enter PNR Or Booking Count"
                      id="pnrOrBookingCount"
                      name="pnrOrBookingCount"
                      class="form-control square"
                      formControlName="pnrOrBookingCount"
                    />
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="issuedTicketOrRoomCount">Issued Ticket Or Room Count</label
                    ><input
                      type="number"
                      placeholder="Enter  Issued Ticket Or Room Count"
                      id="issuedTicketOrRoomCount"
                      name="issuedTicketOrRoomCount"
                      class="form-control square"
                      formControlName="issuedTicketOrRoomCount"
                    />
                  </div>
                </div>
                <div class="col-md-2 col-xl-2 col-lg-2 col-sm-2 col-12">
                  <div class="form-group mb-2">
                    <label for="cancelledTicketOrRoomCount">Cancelled Ticket Or Room Count</label
                    ><input
                      type="number"
                      placeholder="Enter  Cancelled Ticket Or Room Count"
                      id="cancelledTicketOrRoomCount"
                      name="cancelledTicketOrRoomCount"
                      class="form-control square"
                      formControlName="cancelledTicketOrRoomCount"
                    />
                  </div>
                </div>
              </div>
              <div class="float-right mb-2">
                <button type="button" (click)="onSubmitCustomerForm()" class="btn btn-primary mr-2">
                  <i class="ft-search mr-1"></i>
                  {{loading? "loading ...": "Search"}}

                </button>
                <button type="button" (click)="reset()" class="btn btn-secondary">
                  <i class="ft-x mr-1"></i>Reset
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<section id="ngx-datatable-row-details" *ngIf="rows && rows?.length > 0">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-content">
          <div class="card-body">
            <!-- ngx-datatable-filter -->
            <fieldset class="form-group">
              <label
                >Show
                <select
                  name="users-list-select"
                  class="form-control form-control-sm d-inline-block width-100 p-right-25 pl-4 mx-1"
                  (click)="updateLimit($event)"
                >
                  <option value="10">10</option>
                  <option value="25">25</option>
                  <option value="50">50</option>
                  <option value="100">100</option>
                </select>
                entries</label
              >
              <!-- <label for="ngx-filter-ref" class="float-right">
                <input
                  id="ngx-filter-ref"
                  placeholder="Search"
                  class="form-control form-control-sm d-inline-block width-200 ml-1"
                  type="text"
                  (keyup)="filterUpdate($event)"
                />
              </label> -->
            </fieldset>
            <!--  [sorts]="[
            { prop: 'service_request', dir: 'desc' },
            { prop: 'service_request_line', dir: 'desc' },
          ]" -->
            <ngx-datatable
              #tableRowDetails
              class="bootstrap core-bootstrap"
              [columnMode]="ColumnMode.force"
              [headerHeight]="50"
              [footerHeight]="50"
              [reorderable]="reorderable"
              [rowHeight]="'auto'"
              [limit]="limitRef"
              [rows]="rows"
              [scrollbarH]="true"
              [sorts]="sorts"
            >
              <ngx-datatable-row-detail [rowHeight]="'auto'" >
                <ng-template
                  let-row="row"
                  let-expanded="expanded"
                  ngx-datatable-row-detail-template
                  let-rowIndex="rowIndex"

                >
                  <app-sr-summary-deatils-by-sr-srline
                    [srSummaryDetailsData]="row"
                  ></app-sr-summary-deatils-by-sr-srline>
                  <!--  <app-expanded-section [lpoHeaderId]="row.header_id" ></app-expanded-section> -->
                </ng-template>
              </ngx-datatable-row-detail>
              <ngx-datatable-column
                [width]="50"
                [resizeable]="false"
                [sortable]="false"
                [draggable]="false"
                [canAutoResize]="false"
              >
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template let-rowIndex="rowIndex">
                  <a
                    href="javascript:void(0)"
                    [class.datatable-icon-right]="!expanded"
                    [class.datatable-icon-down]="expanded"
                    title="Expand/Collapse Row"
                    (click)="rowDetailsToggleExpand(row, expanded, rowIndex)"
                  >
                  </a>
                </ng-template>
              </ngx-datatable-column>

              <ngx-datatable-column name="SR" prop="service_request" [width]="150">
                <ng-template let-row="row" let-name="value" ngx-datatable-cell-template>
                  {{ row.service_request }} - {{ row.service_request_line }}
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column name="Product" prop="productName" [width]="100"></ngx-datatable-column>
              <!-- <ngx-datatable-column name="Contact" prop="contact_name" [width]="150">

              </ngx-datatable-column> -->
              <ngx-datatable-column name="Contact" prop="contact_name" [width]="150">
                <ng-template let-row="row" let-name="value" ngx-datatable-cell-template>
                  <div class="first-letter-text">
                    {{ row.contact_name }}
                  </div>
                </ng-template>
              </ngx-datatable-column>
              <ngx-datatable-column name="RFQ" prop="request_for_quote_count" [width]="120"></ngx-datatable-column>
              <ngx-datatable-column name="Quote" prop="quote_count" [width]="120"> </ngx-datatable-column>
              <ngx-datatable-column
                name="PNR / Booking"
                prop="pnr_or_booking_count"
                [width]="150"
              ></ngx-datatable-column>
              <ngx-datatable-column
                name="PNR / Booking Passenger"
                prop="pnr_or_booking_passenger_count"
                [width]="220"
              ></ngx-datatable-column>
              <ngx-datatable-column
                name="Ticket / Room"
                prop="issued_ticket_or_room_count"
                [width]="130"
              ></ngx-datatable-column>
              <ngx-datatable-column
                name="Ticket / Room Amount"
                prop="issued_ticket_or_room_total"
                [width]="220"
              ></ngx-datatable-column>
              <ngx-datatable-column
                name="Cancel Ticket/ Room"
                prop="cancelled_ticket_or_room_count"
                [width]="220"
              ></ngx-datatable-column>
              <ngx-datatable-column
                name="Cancel Ticket / Room Total"
                prop="cancelled_ticket_or_room_total"
                [width]="250"
              ></ngx-datatable-column>
              <ngx-datatable-column name="Receipt" prop="receipt_count" [width]="100"></ngx-datatable-column>
              <ngx-datatable-column name="Receipt Amount " prop="receipt_total" [width]="150"></ngx-datatable-column>
              <ngx-datatable-column name="Payment " prop="payment_count" [width]="150"></ngx-datatable-column>
              <ngx-datatable-column name="Payment Amount " prop="payment_total" [width]="160"></ngx-datatable-column>
              <ngx-datatable-column
                name="Purchase Order "
                prop="purchase_order_count"
                [width]="200"
              ></ngx-datatable-column>
              <ngx-datatable-column
                name="Purchase Order Amount "
                prop="purchase_order_total"
                [width]="220"
              ></ngx-datatable-column>
              <ngx-datatable-column name="Invoice " prop="invoice_count" [width]="130"></ngx-datatable-column>
              <ngx-datatable-column name="Invoice Amount " prop="invoice_total" [width]="150"></ngx-datatable-column>
            </ngx-datatable>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
